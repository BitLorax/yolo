
import torch

from utils import (
    predictions_to_bboxes,
)

batch_size = 2
S = 2
B = 2
C = 3

print(f'batch_size: {batch_size}')
print(f'S: {S}')
print(f'B: {B}')
print(f'C: {C}')

predictions = [
    [
        [
            [0.1, 0.2, 0.3, 0.9, 0.1, 0.1, 0.5, 0.5, 0.9, 0.1, 0.1, 0.5, 0.5],
            [0.1, 0.2, 0.3, 0.9, 0.1, 0.1, 0.5, 0.5, 0.9, 0.1, 0.1, 0.5, 0.5]
        ],
        [
            [0.1, 0.2, 0.3, 0.9, 0.1, 0.1, 0.5, 0.5, 0.9, 0.1, 0.1, 0.5, 0.5],
            [0.1, 0.2, 0.3, 0.9, 0.1, 0.1, 0.5, 0.5, 0.9, 0.1, 0.1, 0.5, 0.5]
        ]
    ],
    [
        [
            [0.5, 0.4, 0.3, 0.8, 0.6, 0.6, 0.2, 0.2, 0.8, 0.6, 0.6, 0.2, 0.2],
            [0.5, 0.4, 0.3, 0.8, 0.6, 0.6, 0.2, 0.2, 0.8, 0.6, 0.6, 0.2, 0.2]
        ],
        [
            [0.5, 0.4, 0.3, 0.8, 0.6, 0.6, 0.2, 0.2, 0.8, 0.6, 0.6, 0.2, 0.2],
            [0.5, 0.4, 0.3, 0.8, 0.6, 0.6, 0.2, 0.2, 0.8, 0.6, 0.6, 0.2, 0.2]
        ]

    ]
]
predictions = torch.tensor(predictions)

bboxes = predictions_to_bboxes(predictions, S=S, B=B, C=C)
print(bboxes)
print(bboxes.shape)